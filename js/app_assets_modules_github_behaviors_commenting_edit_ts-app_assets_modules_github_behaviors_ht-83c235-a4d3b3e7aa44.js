"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235"],{66602:(e,t,n)=>{n.d(t,{z:()=>g});var s=n(59753),i=n(19146),o=n(34892),r=n(56959),l=n(64611),a=n(36071),m=n(65935),c=n(22971);let u=[];function d(e){e.querySelector(".js-write-tab").click();let t=e.querySelector(".js-comment-field");t.focus(),(0,s.f)(t,"change")}function f(e){return e.querySelector(".js-comment-edit-form-deferred-include-fragment")}function j(e){f(e)?.setAttribute("loading","eager")}function g(e){let t=e.currentTarget.closest("form"),n=e.currentTarget.getAttribute("data-confirm-text");if((0,l.T)(t)&&!confirm(n))return!1;for(let e of t.querySelectorAll("input, textarea")){let t=e;t.value=t.defaultValue,t.classList.contains("session-resumable-canceled")&&(t.classList.add("js-session-resumable"),t.classList.remove("session-resumable-canceled"))}let s=e.currentTarget.closest(".js-comment");return s&&s.classList.remove("is-comment-editing"),!0}function y(e){let t=e.querySelector("ol");if(t){t.textContent="";let e=u.map((e=>{let t=document.createElement("li");return t.textContent=e,t}));for(let n of e)t.appendChild(n)}e.hidden=!1}function p(e,t){let n=e.querySelector(".js-comment-show-on-error");n&&(n.hidden=!t);let s=e.querySelector(".js-comment-hide-on-error");s&&(s.hidden=t)}(0,a.N7)(".js-comment-header-actions-deferred-include-fragment",{subscribe:e=>(0,r.RB)(e,"loadstart",(()=>{j(e.closest(".js-comment"))}),{capture:!1,once:!0})}),(0,a.N7)(".js-comment .contains-task-list",{add:e=>{j(e.closest(".js-comment"))}}),(0,s.on)("click",".js-comment-edit-button",(function(e){let t=e.currentTarget.closest(".js-comment");t.classList.add("is-comment-editing");let n=f(t);n?n.addEventListener("include-fragment-replaced",(()=>d(t)),{once:!0}):d(t);let s=e.currentTarget.closest(".js-dropdown-details");s&&s.removeAttribute("open")})),(0,s.on)("click",".js-comment-hide-button",(function(e){let t=e.currentTarget.closest(".js-comment");p(t,!1);let n=t.querySelector(".js-minimize-comment");n&&n.classList.remove("d-none");let s=e.currentTarget.closest(".js-dropdown-details");s&&s.removeAttribute("open")})),(0,s.on)("click",".js-comment-hide-minimize-form",(function(e){e.currentTarget.closest(".js-minimize-comment").classList.add("d-none")})),(0,s.on)("click",".js-comment-cancel-button",g),(0,s.on)("click",".js-cancel-issue-edit",(function(e){e.currentTarget.closest(".js-details-container").querySelector(".js-comment-form-error").hidden=!0})),(0,m.AC)(".js-comment-delete, .js-comment .js-comment-update, .js-issue-update, .js-comment-minimize, .js-comment-unminimize",(function(e,t,n){let s=e.closest(".js-comment");s.classList.add("is-comment-loading");let i=s.getAttribute("data-body-version");i&&n.headers.set("X-Body-Version",i)})),(0,m.AC)(".js-comment .js-comment-update",(async function(e,t){let n,s=e.closest(".js-comment"),i=s.querySelector(".js-comment-update-error"),r=s.querySelector(".js-comment-body-error");i instanceof HTMLElement&&(i.hidden=!0),r instanceof HTMLElement&&(r.hidden=!0),u=[];try{n=await t.json()}catch(e){if(422!==e.response.status)throw e;{let t=JSON.parse(e.response.text);if(t.errors)return void(i instanceof HTMLElement&&(i.textContent=`There was an error posting your comment: ${t.errors.join(", ")}`,i.hidden=!1))}}if(!n)return;let a=n.json;a.errors&&a.errors.length>0&&(u=a.errors,y(r));let m=s.querySelector(".js-comment-body");if(m&&a.body&&!(e.hasAttribute("data-submitting-tracking-block-update")&&(0,l.M)(m,!0,!0))&&(m.innerHTML=a.body),null!=a.source){let e=s.querySelector(".js-comment-field");if(e&&(e.value=e.defaultValue=a.source),a.default_merge_commit_message){if(document.querySelector(".js-merge-pr.is-merging")){let e=document.querySelector(".js-merge-pull-request textarea");e instanceof HTMLTextAreaElement&&e.value===e.defaultValue&&(e.value=e.defaultValue=a.default_merge_commit_message)}if(a.default_squash_commit_message&&document.querySelector(".js-merge-pr.is-squashing")){let e=document.querySelector(".js-merge-pull-request textarea");e instanceof HTMLTextAreaElement&&e.value===e.defaultValue&&(e.value=e.defaultValue=a.default_squash_commit_message)}}document.querySelector(".js-merge-box-button-merge")?.setAttribute("data-input-message-value",a.default_merge_commit_message),document.querySelector(".js-merge-box-button-squash")?.setAttribute("data-input-message-value",a.default_squash_commit_message)}s.setAttribute("data-body-version",a.newBodyVersion);let c=s.querySelector(".js-body-version");c instanceof HTMLInputElement&&(c.value=a.newBodyVersion);let d=s.querySelector(".js-discussion-poll");for(let e of(d&&a.poll&&(d.innerHTML=a.poll),s.querySelectorAll("input, textarea"))){let t=e;t.defaultValue=t.value}s.classList.remove("is-comment-stale"),e.hasAttribute("data-submitting-tracking-block-update")||s.classList.remove("is-comment-editing");let f=s.querySelector(".js-comment-edit-history");if(f){let e=await(0,o.a_)(document,a.editUrl);f.textContent="",f.append(e)}})),(0,a.N7)(".js-comment-body-error",{add:e=>{u&&u.length>0&&y(e)}}),(0,m.AC)(".js-comment .js-comment-delete, .js-comment .js-comment-update, .js-comment-minimize, .js-comment-unminimize",(async function(e,t){let n,s=e.closest(".js-comment");try{await t.text()}catch(e){if(422!==(n=e).response.status)throw n;{let t;try{t=JSON.parse(n.response.text)}catch(e){}t&&t.stale&&s.classList.add("is-comment-stale")}}finally{e.dispatchEvent(new CustomEvent("submit:complete",{bubbles:!0,detail:{error:n}}))}s.classList.remove("is-comment-loading")})),(0,m.AC)(".js-timeline-comment-unminimize, .js-timeline-comment-minimize",(async function(e,t){let n=e.closest(".js-minimize-container");try{let e=await t.html();n.replaceWith(e.html)}catch(e){p(n,!0)}})),(0,m.AC)(".js-discussion-comment-unminimize, .js-discussion-comment-minimize",(async function(e,t){let n=e.closest(".js-discussion-comment"),s=n.querySelector(".js-discussion-comment-error");s&&(s.hidden=!0);try{let e=await t.html();n.replaceWith(e.html)}catch(e){if(!(e.response.status>=400&&e.response.status<500))throw e;if(e.response.html){let t=e.response.html.querySelector(".js-discussion-comment").getAttribute("data-error");s instanceof HTMLElement&&(s.textContent=t,s.hidden=!1)}}})),(0,m.AC)(".js-comment-delete",(async function(e,t){await t.json();let n=e.closest(".js-comment-delete-container");!n&&(n=e.closest(".js-comment-container")||e.closest(".js-line-comments"))&&1!==n.querySelectorAll(".js-comment").length&&(n=e.closest(".js-comment"));let s=n?.closest(".js-comment-container")||n?.closest(".js-line-comments");if(n?.remove(),s&&1===s.querySelectorAll(".js-comment").length)for(let e of s.querySelectorAll(".js-delete-on-last-reply-deleted"))e.remove()})),(0,m.AC)(".js-issue-update",(async function(e,t){let n,s=e.closest(".js-details-container"),i=s.querySelector(".js-comment-form-error");try{n=await t.json()}catch(e){i.textContent=e.response?.json?.errors?.[0]||"Something went wrong. Please try again.",i.hidden=!1}if(!n)return;s.classList.remove("open"),i.hidden=!0;let o=n.json;if(null!=o.issue_title){s.querySelector(".js-issue-title").textContent=o.issue_title;let e=s.closest(".js-issues-results");if(e){if(e.querySelector(".js-merge-pr.is-merging")){let t=e.querySelector(".js-merge-pull-request .js-merge-title");t instanceof HTMLInputElement&&t.value===t.defaultValue&&(t.value=t.defaultValue=o.default_merge_commit_title)}else if(e.querySelector(".js-merge-pr.is-squashing")){let t=e.querySelector(".js-merge-pull-request .js-merge-title");t instanceof HTMLInputElement&&t.value===t.defaultValue&&(t.value=t.defaultValue=o.default_squash_commit_title)}let t=e.querySelector("button[value=merge]");t&&t.setAttribute("data-input-title-value",o.default_merge_commit_title);let n=e.querySelector("button[value=squash]");n&&n.setAttribute("data-input-title-value",o.default_squash_commit_title)}}for(let t of(document.title=o.page_title,e.elements))(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&(t.defaultValue=t.value)})),(0,m.AC)(".js-comment-minimize",(async function(e,t){await t.json();let n=e.closest(".js-comment"),s=n.querySelector(".js-minimize-comment");if(s&&s.classList.contains("js-update-minimized-content")){let t=e.querySelector("input[type=submit], button[type=submit]");t&&t.classList.add("disabled");let s=n.closest(".js-comment-container");s&&await(0,c.x0)(s)}else{s&&s.classList.add("d-none");let t=e.closest(".unminimized-comment");t.classList.add("d-none"),t.classList.remove("js-comment");let n=e.closest(".js-minimizable-comment-group").querySelector(".minimized-comment");n&&n.classList.remove("d-none"),n&&n.classList.add("js-comment")}})),(0,m.AC)(".js-comment-unminimize",(async function(e,t){await t.json();let n=e.closest(".js-minimizable-comment-group"),s=n.querySelector(".unminimized-comment"),i=n.querySelector(".minimized-comment");if(s)s.classList.remove("d-none"),s.classList.add("js-comment"),i&&i.classList.add("d-none"),i&&i.classList.remove("js-comment");else{if(i){let e=i.querySelector(".timeline-comment-actions");e&&e.classList.add("d-none"),i.classList.remove("js-comment")}let e=n.closest(".js-comment-container");await(0,c.x0)(e)}})),(0,s.on)("details-menu-select",".js-comment-edit-history-menu",(e=>{let t=e.detail.relatedTarget.getAttribute("data-edit-history-url");if(!t)return;e.preventDefault();let n=(0,o.a_)(document,t);(0,i.W)({content:n,dialogClass:"Box-overlay--wide overflow-visible",errorMessage:"Couldn't display edit history diff"})}),{capture:!0})},81775:(e,t,n)=>{n.d(t,{G:()=>a});var s=n(254),i=n(36071),o=n(59753);function r(e){let t=e.getAttribute("data-required-value"),n=e.getAttribute("data-required-value-prefix");if(e.value===t)e.setCustomValidity("");else{let s=t;n&&(s=n+s),e.setCustomValidity(s)}}(0,s.q6)("[data-required-value]",(function(e){r(e.currentTarget)})),(0,o.on)("change","[data-required-value]",(function(e){let t=e.currentTarget;r(t),a(t.form)})),(0,s.q6)("[data-required-trimmed]",(function(e){let t=e.currentTarget;""===t.value.trim()?t.setCustomValidity(t.getAttribute("data-required-trimmed")):t.setCustomValidity("")})),(0,o.on)("change","[data-required-trimmed]",(function(e){let t=e.currentTarget;""===t.value.trim()?t.setCustomValidity(t.getAttribute("data-required-trimmed")):t.setCustomValidity(""),a(t.form)})),(0,s.ZG)("input[pattern],input[required],textarea[required],input[data-required-change],textarea[data-required-change],input[data-required-value],textarea[data-required-value]",(e=>{let t=e.checkValidity();function n(){let n=e.checkValidity();n!==t&&e.form&&a(e.form),t=n}e.addEventListener("input",n),e.addEventListener("blur",(function t(){e.removeEventListener("input",n),e.removeEventListener("blur",t)}))}));let l=new WeakMap;function a(e){let t=e.checkValidity();for(let n of e.querySelectorAll("button[data-disable-invalid]"))n.disabled=!t}(0,i.N7)("button[data-disable-invalid]",{constructor:HTMLButtonElement,initialize(e){let t=e.form;t&&(function(e){l.get(e)||(e.addEventListener("change",(()=>a(e))),l.set(e,!0))}(t),e.disabled=!t.checkValidity())}}),(0,i.N7)("input[data-required-change], textarea[data-required-change]",(function(e){let t="radio"===e.type&&e.form?e.form.elements.namedItem(e.name).value:null;function n(n){let s=e.form;if(n&&"radio"===e.type&&s&&t)for(let n of s.elements.namedItem(e.name))n instanceof HTMLInputElement&&n.setCustomValidity(e.value===t?"unchanged":"");else e.setCustomValidity(e.value===(t||e.defaultValue)?"unchanged":"")}e.addEventListener("input",n),e.addEventListener("change",n),n(),e.form&&a(e.form)})),document.addEventListener("reset",(function(e){if(e.target instanceof HTMLFormElement){let t=e.target;setTimeout((()=>a(t)))}}))}}]);